<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Globite - æ¯æ—¥ä¸€åœ‹</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <style>
        :root { --primary: #2563eb; --bg: #f1f5f9; }
        body { font-family: -apple-system, system-ui, sans-serif; background-color: var(--bg); margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .card { background: white; width: 90%; max-width: 380px; border-radius: 28px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; text-align: center; }
        .image-container { width: 100%; height: 200px; background: #eee; }
        .image-container img { width: 100%; height: 100%; object-fit: contain; }
        .content { padding: 24px; }
        .tag { display: inline-block; background: #f1f5f9; padding: 5px 14px; border-radius: 50px; font-size: 13px; color: #64748b; margin-bottom: 12px; font-weight: 500; }
        h1 { margin: 5px 0; font-size: 26px; color: #0f172a; line-height: 1.2; }
        .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 20px 0; text-align: left; }
        .info-item { background: #f8fafc; padding: 12px; border-radius: 12px; border: 1px solid #edf2f7; }
        .label { color: #94a3b8; font-size: 11px; display: block; margin-bottom: 4px; }
        .value { font-weight: 600; color: #334155; font-size: 15px; }
        /* é¦–éƒ½é€£çµæ¨£å¼ */
        .capital-link { color: var(--primary); text-decoration: none; display: flex; align-items: center; gap: 4px; }
        .capital-link:active { opacity: 0.6; }
        .btn-group { display: flex; gap: 10px; margin-top: 10px; }
        button { flex: 1.5; background: var(--primary); color: white; border: none; padding: 14px; border-radius: 14px; font-size: 16px; font-weight: 600; cursor: pointer; }
        button.secondary { flex: 1; background: #f1f5f9; color: #475569; }
        #status-msg { font-size: 12px; color: #94a3b8; margin-top: 10px; }
    </style>
</head>
<body>

<div class="card">
    <div class="image-container">
        <img id="flagImg" src="" alt="è®€å–ä¸­...">
    </div>
    <div class="content">
        <div id="region" class="tag">æ­£åœ¨é€£ç·š...</div>
        <h1 id="countryName">è¼‰å…¥ä¸­</h1>
        
        <div class="info-grid">
            <div class="info-item">
                <span class="label">å®˜æ–¹é¦–éƒ½ (é»æ“Šè·³è½‰)</span>
                <a id="capitalLink" href="#" target="_blank" class="capital-link">
                    <span id="capital" class="value">-</span>
                    <span style="font-size: 12px;">ğŸ“</span>
                </a>
            </div>
            <div class="info-item">
                <span class="label">ä¼°è¨ˆäººå£</span>
                <span id="population" class="value">-</span>
            </div>
        </div>

        <div class="btn-group">
            <a id="wikiLink" href="#" target="_blank" style="flex:1">
                <button class="secondary">ç™¾ç§‘</button>
            </a>
            <button onclick="nextCountry()">ä¸‹ä¸€ç«™</button>
        </div>
        <div id="status-msg"></div>
    </div>
</div>

<script>
    let allCountries = [];

    const regionMap = {
        'Asia': 'äºæ´²', 'Europe': 'æ­æ´²', 'Africa': 'éæ´²',
        'Oceania': 'å¤§æ´‹æ´²', 'Americas': 'ç¾æ´²', 'Antarctica': 'å—æ¥µæ´²'
    };

    async function fetchCountries() {
        const status = document.getElementById('status-msg');
        try {
            const response = await fetch('https://restcountries.com/v3.1/all?fields=name,translations,flags,continents,capital,population,maps');
            if (!response.ok) throw new Error();
            const data = await response.json();
            
            allCountries = data.map(c => {
                const zhName = c.translations?.zho?.common || c.name.common;
                const enName = c.name.common;
                const regionEn = c.continents ? c.continents[0] : 'Unknown';
                const regionZh = regionMap[regionEn] || regionEn;
                const cap = c.capital ? c.capital[0] : 'ç„¡';

                return {
                    displayName: `${zhName}<br><span style="font-size:15px; color:#94a3b8; font-weight:normal;">${enName}</span>`,
                    pureZhName: zhName,
                    flag: c.flags.png,
                    regionDisplay: `${regionZh} (${regionEn})`,
                    capitalName: cap,
                    population: c.population ? c.population.toLocaleString() : 'ä¸è©³',
                    wiki: `https://zh.wikipedia.org/wiki/${zhName}`,
                    // é¦–éƒ½åœ°åœ–é€£çµï¼šç›´æ¥æœå°‹ "é¦–éƒ½å, åœ‹å®¶å" ç¢ºä¿ç²¾ç¢ºåº¦
                    capitalMap: `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(cap + ',' + enName)}`
                };
            });
            status.innerText = "";
            nextCountry();
        } catch (e) {
            status.innerText = "é€£ç·šå¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯";
        }
    }

    function nextCountry() {
        if (allCountries.length === 0) return;
        const c = allCountries[Math.floor(Math.random() * allCountries.length)];
        
        document.getElementById('flagImg').src = c.flag;
        document.getElementById('region').innerText = c.regionDisplay;
        document.getElementById('countryName').innerHTML = c.displayName;
        document.getElementById('capital').innerText = c.capitalName;
        document.getElementById('population').innerText = c.population;
        document.getElementById('wikiLink').href = c.wiki;
        document.getElementById('capitalLink').href = c.capitalMap;
    }

    fetchCountries();
</script>

</body>
</html>